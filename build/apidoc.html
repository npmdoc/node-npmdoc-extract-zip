<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/maxogden/extract-zip"

    >extract-zip (v1.6.0)</a>
</h1>
<h4>unzip a zip file into a directory using 100% pure gluten-free organic javascript</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.extract-zip">module extract-zip</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.extract-zip.extract-zip">
            function <span class="apidocSignatureSpan"></span>extract-zip
            <span class="apidocSignatureSpan">(zipPath, opts, cb)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.extract-zip" id="apidoc.module.extract-zip">module extract-zip</a></h1>


    <h2>
        <a href="#apidoc.element.extract-zip.extract-zip" id="apidoc.element.extract-zip.extract-zip">
        function <span class="apidocSignatureSpan"></span>extract-zip
        <span class="apidocSignatureSpan">(zipPath, opts, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">extract-zip = function (zipPath, opts, cb) {
  debug(&#x27;creating target directory&#x27;, opts.dir)

  mkdirp(opts.dir, function (err) {
    if (err) return cb(err)
    openZip()
  })

  function openZip () {
    debug(&#x27;opening&#x27;, zipPath, &#x27;with opts&#x27;, opts)

    yauzl.open(zipPath, {lazyEntries: true}, function (err, zipfile) {
      if (err) return cb(err)

      var cancelled = false

      zipfile.readEntry()

      zipfile.on(&#x27;close&#x27;, function () {
        if (!cancelled) {
          debug(&#x27;zip extraction complete&#x27;)
          cb()
        }
      })

      zipfile.on(&#x27;entry&#x27;, function (entry) {
        if (cancelled) {
          debug(&#x27;skipping entry&#x27;, entry.fileName, {cancelled: cancelled})
          return
        }

        debug(&#x27;zipfile entry&#x27;, entry.fileName)

        if (/^__MACOSX\//.test(entry.fileName)) {
          // dir name starts with __MACOSX/
          zipfile.readEntry()
          return
        }

        extractEntry(entry, function (err) {
          // if any extraction fails then abort everything
          if (err) {
            cancelled = true
            zipfile.close()
            return cb(err)
          }
          debug(&#x27;finished processing&#x27;, entry.fileName)
          zipfile.readEntry()
        })
      })

      function extractEntry (entry, done) {
        if (cancelled) {
          debug(&#x27;skipping entry extraction&#x27;, entry.fileName, {cancelled: cancelled})
          return setImmediate(done)
        }

        if (opts.onEntry) {
          opts.onEntry(entry, zipfile)
        }

        var dest = path.join(opts.dir, entry.fileName)

        // convert external file attr int into a fs stat mode int
        var mode = (entry.externalFileAttributes &#x3e;&#x3e; 16) &#x26; 0xFFFF
        // check if it&#x27;s a symlink or dir (using stat mode constants)
        var IFMT = 61440
        var IFDIR = 16384
        var IFLNK = 40960
        var symlink = (mode &#x26; IFMT) === IFLNK
        var isDir = (mode &#x26; IFMT) === IFDIR

        // check for windows weird way of specifying a directory
        // https://github.com/maxogden/extract-zip/issues/13#issuecomment-154494566
        var madeBy = entry.versionMadeBy &#x3e;&#x3e; 8
        if (!isDir) isDir = (madeBy === 0 &#x26;&#x26; entry.externalFileAttributes === 16)

        // if no mode then default to default modes
        if (mode === 0) {
          if (isDir) {
            if (opts.defaultDirMode) mode = parseInt(opts.defaultDirMode, 10)
            if (!mode) mode = 493 // Default to 0755
          } else {
            if (opts.defaultFileMode) mode = parseInt(opts.defaultFileMode, 10)
            if (!mode) mode = 420 // Default to 0644
          }
        }

        debug(&#x27;extracting entry&#x27;, { filename: entry.fileName, isDir: isDir, isSymlink: symlink })

        // reverse umask first (~)
        var umask = ~process.umask()
        // &#x26; with processes umask to override invalid perms
        var procMode = mode &#x26; umask

        // always ensure folders are created
        var destDir = dest
        if (!isDir) destDir = path.dirname(dest)

        debug(&#x27;mkdirp&#x27;, {dir: destDir})
        mkdirp(destDir, function (err) {
          if (err) {
            debug(&#x27;mkdirp error&#x27;, destDir, {error: err})
            cancelled = true
            return done(err)
          }

          if (isDir) return done()

          debug(&#x27;opening read stream&#x27;, dest)
          zipfile.openReadStream(entry, function (err, readStream) {
            if (err) {
              debug(&#x27;openReadStream error&#x27;, err)
              cancelled = true
              return done(err)
            }

            readStream.on(&#x27;error&#x27;, function (err) {
              console.log(&#x27;read err&#x27;, err)
            })

            if (symlink) writeSymlink()
            else writeStream()

            function writeStream () {
              var writeStream = fs.createWriteStream(dest, {mode: procMode})
              readStream.pipe(writeStream)

              writeStream.on(&#x27;finish&#x27;, function () {
                done()
              })

              writeStream.on(&#x27;error&#x27;, function (err) {
                debug(&#x27;write error&#x27;, {error: err}) ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
